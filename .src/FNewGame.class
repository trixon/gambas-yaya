' Gambas class file

Public Sub Form_Open()

  cmbGame.List = MGameLoader.Titles()
  cmbGame.Text = MGameLoader.TextById(MSettings.GameId)
  cmbVariant.Index = 0
  cmbPlayers.Text = MSettings.Players

End

Public Sub Run() As Boolean

  Return Me.ShowModal()

End

Public Sub btnOK_Click()

  MSettings.GameId = MGameLoader.IdByText(cmbGame.Text)
  MSettings.Players = cmbPlayers.Text
  Me.Close(True)

End

Public Sub btnCancel_Click()

  Me.Close()

End

Public Sub cmbGame_Click()

  Debug MGameLoader.IdByText(cmbGame.Text)
  cmbVariant.List = MGameLoader.VariantsByText(cmbGame.Text)
  cmbVariant.List = MGameLoader.LocalizedVariants(MGameLoader.VariantsByText(cmbGame.Text))

End
