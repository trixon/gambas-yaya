' Gambas class file

Public Sub Form_Open()

  cmbGame.Index = 0
  cmbGame.List = MGameLoader.Titles()
  cmbVariant.Index = 0
  cmbPlayers.Index = Settings[FMain.KEY_GAME_PLAYERS, 1]

End

Public Sub Run() As Boolean

  Return Me.ShowModal()

End

Public Sub btnOK_Click()

  Settings[FMain.KEY_GAME_PLAYERS] = cmbPlayers.Index
  Me.Close(True)

End

Public Sub btnCancel_Click()

  Me.Close()

End

Public Sub cmbGame_Click()

  Debug MGameLoader.IdByText(cmbGame.Text)
  cmbVariant.List = MGameLoader.VariantsByText(cmbGame.Text)

End
