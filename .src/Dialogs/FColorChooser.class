' Gambas class file

Static Public Color As String
Static Public Value As Integer

Static Private $iColor As Integer
Static Private $bAlpha As Boolean
Static Private $sTitle As String

Private Const DEFAULT_COLOR As String = "-"

Static Public Function Run(iColor As Integer, Optional bAlpha As Boolean, Optional sTitle As String) As Integer

  $iColor = iColor
  $bAlpha = bAlpha
  $sTitle = sTitle

  Return FColorChooser.ShowModal()

End

Public Sub btnOK_Click()

  $iColor = dlgColor.SelectedColor
  Me.Close($iColor)

End

Public Sub btnCancel_Click()

  Me.Close($iColor)

End

Public Sub Form_Open()

  Dim sSystem As String

  dlgColor.SelectedColor = $iColor  '
  dlgColor.ShowAlpha = $bAlpha

  If $sTitle Then
    Me.Title = $sTitle
  Else
    $sTitle = ("Select a color")
  Endif

End

Public Sub dlgColor_Activate()

  btnOK.Value = True

End
