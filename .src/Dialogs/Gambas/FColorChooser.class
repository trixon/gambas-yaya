' Gambas class file

Static Public Color As String
Static Public Value As Integer

Static Private $iColor As Integer
Static Private $bAlpha As Boolean
Static Private $sTitle As String

Private Const DEFAULT_COLOR As String = "-"

Static Public Function Run(iColor As Integer, Optional bAlpha As Boolean, Optional sTitle As String) As Integer

  $iColor = iColor
  $bAlpha = bAlpha
  $sTitle = sTitle

  Return FColorChooser.ShowModal()
  ' 'IF NOT $sColor THEN $sColor = Color
  ' 'IF NOT $sColor THEN $sColor = "&H" & Hex$(Value, 6)
  ' If FColorChooser.ShowModal() Then
  '   Color = $sColor
  '   If $sColor Then
  '     Try Value = Val($sColor)
  '     If Error Then
  '       Value = Object.GetProperty(Classes["Color"], $sColor)
  '     Else
  '       If $bAlpha Then
  '         Color = "&H" & Hex$(Value, 8) & "&"
  '       Else
  '         Color = "&H" & Hex$(Value, 6) & "&"
  '       Endif
  '     Endif
  '   Else
  '     Value = -1
  '   Endif
  '   'DEBUG Value;; "'"; Color; "'"
  ' Else
  '   Return True
  ' Endif

End

Public Sub btnOK_Click()

  $iColor = dlgColor.SelectedColor
  Me.Close($iColor)

End

Public Sub btnCancel_Click()

  Me.Close($iColor)

End

Public Sub Form_Open()

  Dim sSystem As String

  '   Settings.Read(Me)

  dlgColor.SelectedColor = $iColor
  ' If Not IsNull(Val($sColor)) Then
  ' Endif
  '
  ' dlgColor.ShowAlpha = $bAlpha
  '
  If $sTitle Then
    Me.Title = $sTitle
  Else
    $sTitle = ("Select a color")
  Endif

End

Public Sub dlgColor_Activate()

  btnOK.Value = True

End

Public Sub Form_Close()

  '   Settings.Write(Me)

End
