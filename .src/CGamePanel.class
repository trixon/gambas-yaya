' Gambas class file

Property Read DicePanel As DicePanel
Property Read Panel As Panel

Private $hDicePanel As DicePanel
Private $hPanel As Panel
Private $hScorecard As CScorecard
Private $hGameDef As CGameDef

Public Sub _new(hContainer As Container)

  $hPanel = New Panel(hContainer) As "Panel"

  With $hPanel
    .Arrangement = Arrange.Vertical
    .Expand = True
  End With

  $hScorecard = New CScorecard($hPanel)
  $hDicePanel = New DicePanel($hPanel) As "DicePanel"

  DicePanel.ReverseMouseScroll = MSettings.ReverseMouseScroll

End

Public Sub DicePanel_RollFinished()

  $hScorecard.ParseDice($hDicePanel.Values)

End

Public Sub DicePanel_RollRequest()

  $hDicePanel.Roll()

End

Public Sub Close()

  $hDicePanel.Close()

End

Public Sub NewGame()

  $hGameDef = MGameLoader.GameDefs[MSettings.GameId]

  $hScorecard.NewGame()
  $hDicePanel.DiceCount = $hGameDef.Dice
  $hDicePanel.NewGame()

End

Public Sub Open()

  $hDicePanel.Open()

End

Public Sub Settings()

  $hScorecard.Settings()

End

Private Function Panel_Read() As Panel

  Return $hPanel

End

Private Function DicePanel_Read() As DicePanel

  Return $hDicePanel

End
