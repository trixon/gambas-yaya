' Gambas class file

Property Read DicePanel As DicePanel

Property Read Panel As Panel

Private $hPanel As Panel
Private $hDicePanel As DicePanel
Private $hScorePanel As CScorePanel

Public Sub _new(hContainer As Container)

  $hPanel = New Panel(hContainer) As "Panel"

  With $hPanel
    .Arrangement = Arrange.Vertical
    .Background = &H1B3F0F&
    .Border = Border.Sunken
    .Height = 700
    .Padding = 8
    .Width = 1024
  End With

  $hScorePanel = New CScorePanel($hPanel)
  $hDicePanel = New DicePanel($hPanel) As "DicePanel"
  $hDicePanel.DiceCount = 5

  DicePanel.ReverseMouseScroll = MSettings.ReverseMouseScroll

End

Public Sub DicePanel_RollFinished()

  Debug "roll finished - eval"

End

Public Sub DicePanel_RollRequest()

  $hDicePanel.Roll()

End

Public Sub Close()

  Debug
  $hDicePanel.Close()

End

Public Sub NewGame()

  Debug
  $hScorePanel.NewGame()
  $hDicePanel.NewGame()

End

Public Sub Open()

  Debug
  $hDicePanel.Open()

End

Public Sub Settings()

  $hScorePanel.Settings()

End

Private Function Panel_Read() As Panel

  Return $hPanel

End

Private Function DicePanel_Read() As DicePanel

  Return $hDicePanel

End
