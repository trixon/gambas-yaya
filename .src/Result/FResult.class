' Gambas class file

Public Enum DoNothing, NewRepeat, NewCustom

Public Sub _new()

  MGameLoader.LoadAll()
  lblTitle.Text = MGameLoader.TextById(MSettings.GameId)
  Me.Width = 360
  mbtNew.SetFocus()

End

Public Sub Run(hResultItems As CResultItem[]) As Integer

  Dim hResultItem As CResultItem
  Dim i As Integer

  hGridView.Columns.Count = 3
  hGridView.Rows.Count = hResultItems.Length

  For i = 0 To hResultItems.Max
    hGridView[i, 0].Text = CStr(i + 1) & "."
    hGridView[i, 0].Alignment = Align.Right
    hGridView[i, 0].Padding = 4
    hGridView.Columns[0].Width = 50

    hGridView[i, 1].Text = hResultItems[i].Name
    hGridView[i, 1].Padding = 4
    hGridView.Columns[1].Width = 200

    hGridView[i, 2].Text = hResultItems[i].Score
    hGridView[i, 2].Alignment = Align.Right

  Next

  Return Me.ShowModal()

End

Public Sub mnuNewGame_Click()

  Me.Close(NewCustom)

End

Public Sub btnCancel_Click()

  Me.Close(DoNothing)

End

Public Sub dwgBackground_Draw()

  Paint.Brush = Paint.Color(Color.LightBackground)
  MGuiUtils.PaintRoundedRect(0, 0, dwgBackground.W, dwgBackground.H, 8)
  Paint.Fill

End

Public Sub mbtNew_Click()

  Me.Close(NewRepeat)

End
