' Gambas class file

Private $hModPlayers As FModPlayers
Private $hModScorecard As FModScorecard
Private $hModDice As FModDice
Private $hModColors As FModColor
Private Enum Players, Scorecard, Dice, Colors

Public Sub _new()

  Dim i As Integer
  Dim aModHeader As New CModHeader[]
  Dim hModHeader As CModHeader

  hModHeader = New CModHeader(("Players"), "images/system-users.png", Players)
  aModHeader.Add(hModHeader)
  hModHeader = New CModHeader(("Scorecard"), "images/accessories-text-editor.png", Scorecard)
  aModHeader.Add(hModHeader)
  hModHeader = New CModHeader(("Dice"), "images/dice.png", Dice)
  aModHeader.Add(hModHeader)
  hModHeader = New CModHeader(("Colors"), "images/preferences-desktop-color.png", Colors)
  aModHeader.Add(hModHeader)

  ipnModules.Count = aModHeader.Length

  For i = 0 To aModHeader.Max
    ipnModules[aModHeader[i].Index].Text = aModHeader[i].Text
    ipnModules[aModHeader[i].Index].Picture = Picture.Load(aModHeader[i].Picture)
  Next

  $hModPlayers = New FModPlayers(ipnModules[Players])
  $hModScorecard = New FModScorecard(ipnModules[Scorecard])
  $hModDice = New FModDice(ipnModules[Dice])
  $hModColors = New FModColor(ipnModules[Colors])

  ipnModules.Index = Scorecard

End

Public Sub Run() As Boolean

  Return Me.ShowModal()

End

Public Sub btnOK_Click()

  $hModPlayers.Save()
  $hModScorecard.Save()
  $hModDice.Save()
  $hModColors.Save()

  Me.Close(True)

End

Public Sub btnCancel_Click()

  Me.Close

End
