' Gambas class file

Property Read Order As Integer[]
Property Read Playable As Boolean[]
Property Rolls As Integer
Property TempValues As Integer[]
Property Read Values As Integer[]

Private $aPlayable As Boolean[]
Private $aRowOrder As Integer[]
Private $aTempValues As Integer[]
Private $aValues As Integer[]

Private $iRolls As Integer

Private $hGameDef As CGameDef

Public Sub NewGame(hGameDef As CGameDef)

  Dim i As Integer

  $hGameDef = hGameDef
  $iRolls = 0
  $aRowOrder = New Integer[]
  $aPlayable = New Boolean[$hGameDef.Rows.Length]
  $aValues = New Integer[$hGameDef.Rows.Length]
  For i = 0 To $hGameDef.Rows.Max
    $aPlayable[i] = True
    $aValues[i] = 0
  Next

End

Public Sub Register(Row As Integer, Value As Integer)

  $aValues[Row] = Value
  $aRowOrder.Add(Row)
  $aPlayable[Row] = False

End

Public Function Undo() As Integer

  Dim iRow As Integer = $aRowOrder.Pop()

  $aValues[iRow] = 0
  $aPlayable[iRow] = True

  Return iRow

End

Private Function Rolls_Read() As Integer

  Return $iRolls

End

Private Sub Rolls_Write(Value As Integer)

  $iRolls = Value

End

Private Function Playable_Read() As Boolean[]

  Return $aPlayable

End

Private Function Values_Read() As Integer[]

  Return $aValues

End

Private Function Order_Read() As Integer[]

  Return $aRowOrder

End

Private Function TempValues_Read() As Integer[]

  Return $aTempValues

End

Private Sub TempValues_Write(Value As Integer[])

  $aTempValues = Value

End
